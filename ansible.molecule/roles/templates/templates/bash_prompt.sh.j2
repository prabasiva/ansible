#!/bin/bash
# Custom bash prompt configuration - Generated by Ansible

{% if bash_prompt.color_enabled %}
# Enable color support
if [ -x /usr/bin/dircolors ]; then
    test -r ~/.dircolors && eval "$(dircolors -b ~/.dircolors)" || eval "$(dircolors -b)"
fi
{% endif %}

{% if bash_prompt.show_git_branch %}
# Function to show git branch
parse_git_branch() {
    git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/(\1)/'
}
{% endif %}

{% if bash_prompt.show_last_command_status %}
# Function to show last command status
last_command_status() {
    if [ $? -eq 0 ]; then
        echo -e "\033[0;32m✓\033[0m"
    else
        echo -e "\033[0;31m✗\033[0m"
    fi
}
{% endif %}

# Set custom prompt
{% if bash_prompt.custom_prompt is defined %}
PS1="{{ bash_prompt.custom_prompt }}"
{% else %}
{% if bash_prompt.color_enabled %}
PS1='\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]'
{% if bash_prompt.show_git_branch %}
PS1="$PS1\[\033[01;33m\]\$(parse_git_branch)\[\033[00m\]"
{% endif %}
{% if bash_prompt.show_last_command_status %}
PS1="\$(last_command_status) $PS1"
{% endif %}
PS1="$PS1\$ "
{% else %}
PS1='\u@\h:\w\$ '
{% endif %}
{% endif %}

export PS1